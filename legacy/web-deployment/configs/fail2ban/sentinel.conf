# Fail2ban filter for SENTINEL API
# Location: /etc/fail2ban/filter.d/sentinel.conf
#
# Detecta tentativas de login falhadas e ataques de brute force

[Definition]

# Padrão de falha de autenticação
failregex = ^.*"POST /api/v1/login HTTP.*" 401 .*$
            ^.*"POST /api/v1/register HTTP.*" 422 .*$
            ^.*".*" 401 .*$

# Padrão de ignorar (health checks, etc)
ignoreregex = ^.*"GET /api/v1/health/.*" 200 .*$
